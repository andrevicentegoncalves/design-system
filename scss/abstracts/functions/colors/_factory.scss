@use 'sass:map';

// ============================================================================= //
//                           FUNCTIONS: COLOR FACTORY                            //
// ============================================================================= //

@function create-color($color-config, $custom-lightness, $base-lightness, $family, $weight: 500) {
  @if not map.has-key($color-config, $family) {
    @error "Color family '#{$family}' not found. Available: #{map.keys($color-config)}";
  }
  
  $color-def: map.get($color-config, $family);
  $hue: map.get($color-def, 'hue');
  $saturation: map.get($color-def, 'saturation');
  
  $lightness: null;
  
  @if $custom-lightness and map.has-key($custom-lightness, $family) {
    $family-overrides: map.get($custom-lightness, $family);
    @if map.has-key($family-overrides, $weight) {
      $lightness: map.get($family-overrides, $weight);
    }
  }
  
  @if not $lightness {
    @if not map.has-key($base-lightness, $weight) {
      @error "Weight '#{$weight}' not found. Available: #{map.keys($base-lightness)}";
    }
    $lightness: map.get($base-lightness, $weight);
  }
  
  @return hsl($hue, $saturation, $lightness);
}