@use 'sass:map';
@use 'sass:list';
@use '../abstracts' as *;

/* ========================================================================== */
/*                                LAYOUT: GRID LEGACY                         */
/* ========================================================================== */


//-------------------------------------------
// Base Grid Container
//-------------------------------------------

.grid-container {
    @include grid-container();
    
    // Script safety measures
    script {
        display: none !important;
        visibility: hidden !important;
        height: var(--space-none) !important;
        width: var(--space-none) !important;
        overflow: hidden !important;
        position: absolute !important;
        z-index: -1 !important;
        opacity: var(--space-none) !important;
    }
}

//-------------------------------------------
// Responsive Container Widths
//-------------------------------------------
// Uses CSS custom properties from token system
// Automatically responsive via --container-max-width token

//-------------------------------------------
// Grid Item Base Styles
//-------------------------------------------

.grid-item {
    overflow: hidden;
    -webkit-transition: var(--transition-base);
    transition: var(--transition-base);
    height: auto !important;
    min-height: unset !important;
    display: flex !important;
    flex-direction: column !important;

    // Height override for zero-height items
    &[style*="height: 0px"] {
        height: auto !important;
        min-height: unset !important;
        margin: var(--space-none) !important;
    }
}

//-------------------------------------------
// Grid Item Content
//-------------------------------------------

.grid-item-content {
    padding: var(--space-base);
}

//-------------------------------------------
// Predefined Grid Layouts (Mobile-First)
//-------------------------------------------

.grid-2 {
    @include responsive-grid((
        xs: 1,
        s: 1,
        m: 2,
        l: 2,
        xl: 2
    ));
}

.grid-3 {
    @include responsive-grid((
        xs: 1,
        s: 2,
        m: 3,
        l: 3,
        xl: 3
    ));
}

.grid-4 {
    @include responsive-grid((
        xs: 1,
        s: 2,
        m: 3,
        l: 4,
        xl: 4
    ));
}

//-------------------------------------------
// 12-Column Grid System
//-------------------------------------------

.row {
    @include grid-layout(12, 16px);
    grid-auto-flow: row;
}

// Generate responsive column classes (.col-{breakpoint}-{number})
// Mobile-first: xs is default, then s, m, l, xl
@each $breakpoint-key, $breakpoint-value in (
    xs: 0,
    s: var(--breakpoint-s),
    m: var(--breakpoint-m),
    l: var(--breakpoint-l),
    xl: var(--breakpoint-xl)
) {
    @if $breakpoint-key == 'xs' {
        // Base mobile styles (no media query)
        @for $i from 1 through 12 {
            .row .col-#{$breakpoint-key}-#{$i} { 
                @include grid-span($i);
            }
        }
    } @else {
        // Progressive enhancement for larger screens
        @include bp-up($breakpoint-key) {
            @for $i from 1 through 12 {
                .row .col-#{$breakpoint-key}-#{$i} { 
                    @include grid-span($i);
                }
            }
        }
    }
}

// Default non-responsive column spans
@for $i from 1 through 12 {
    .col-#{$i} {
        @include grid-span($i);
    }
}

//-------------------------------------------
// Fractional Layout Classes
//-------------------------------------------

.grid-fourth { @include grid-span(3); }
.grid-third { @include grid-span(4); }
.grid-half { @include grid-span(6); }
.grid-two-thirds { @include grid-span(8); }
.grid-three-fourths { @include grid-span(9); }

//-------------------------------------------
// Grid Column Start Positions
//-------------------------------------------

.grid-start-first { grid-column-start: 1; }
.grid-start-fourth { grid-column-start: 4; }
.grid-start-third { grid-column-start: 5; }
.grid-start-half { grid-column-start: 7; }
.grid-start-two-thirds { grid-column-start: 9; }
.grid-start-three-fourths { grid-column-start: 10; }

//-------------------------------------------
// Responsive Column Start Positions
//-------------------------------------------

@each $breakpoint-key in (xs, s, m, l, xl) {
    @if $breakpoint-key == 'xs' {
        // Base mobile styles
        @for $i from 1 through 11 {
            .grid-start-#{$breakpoint-key}-#{$i} { 
                grid-column-start: $i; 
            }
        }
    } @else {
        // Progressive enhancement
        @include bp-up($breakpoint-key) {
            @for $i from 1 through 11 {
                .grid-start-#{$breakpoint-key}-#{$i} { 
                    grid-column-start: $i; 
                }
            }
        }
    }
}

//-------------------------------------------
// Gap Utilities
//-------------------------------------------

.gap-05 { gap: 0.5rem; }
.gap-1 { gap: 1rem; }
.gap-2 { gap: 2rem; }
.gap-3 { gap: 3rem; }
.column-gap-xxl { column-gap: var(--space-xxl); }
.column-gap-xxxl { column-gap: var(--space-xxxl); }

//-------------------------------------------
// Grid Alignment Utilities
//-------------------------------------------

.grid-align-center { align-items: center; }
.grid-justify-center { justify-items: center; }
.grid-auto-flow-dense { grid-auto-flow: dense; }

//-------------------------------------------
// Gutter Control
//-------------------------------------------

.no-gutters {
    margin-right: 0;
    margin-left: 0;
    gap: 0;

    > .col,
    > [class*="col-"] {
        padding-right: 0;
        padding-left: 0;
    }
}

//-------------------------------------------
// Special Cases
//-------------------------------------------

.card.grid-item { padding: 0; }
.grid .grid { grid-column: 1 / -1; }

//-------------------------------------------
// Responsive Visibility Utilities (Mobile-First)
//-------------------------------------------

// Hide on breakpoint and up
@each $breakpoint-key in (xs, s, m, l, xl) {
    @if $breakpoint-key != 'xs' {
        @include bp-up($breakpoint-key) {
            .hidden-#{$breakpoint-key}-up {
                display: none !important;
            }
        }
    }
}

// Hide on breakpoint and down
.hidden-xs-down {
    display: none !important; // Always hidden (xs and down = everything on xs)
}

@include bp-down(s) {
    .hidden-s-down {
        display: none !important;
    }
}

@include bp-down(m) {
    .hidden-m-down {
        display: none !important;
    }
}

@include bp-down(l) {
    .hidden-l-down {
        display: none !important;
    }
}

//-------------------------------------------
// Responsive Grid Container Variations (Mobile-First)
//-------------------------------------------

.container-2-2-1 {
    @include responsive-columns(1, 2, 2);
}

.container-3-2-1 {
    @include responsive-columns(1, 2, 3);
}

.container-3-3-1 {
    @include responsive-columns(1, 3, 3);
}
  
.container-4-2-1 {
    @include responsive-columns(1, 2, 4);
}
 
.container-4-2-2 {
    @include responsive-columns(2, 2, 4);
}

.container-4-3-2 {
    @include responsive-columns(2, 3, 4);
}

.container-5-3-1 {
    @include responsive-columns(1, 3, 5);
}

.container-5-3-2 {
    @include responsive-columns(2, 3, 5);
}

.container-5-4-2 {
    @include responsive-columns(2, 4, 5);
}
  
.container-6-3-1 {
    @include responsive-columns(1, 3, 6);
}

.container-6-3-2 {
    @include responsive-columns(2, 3, 6);
}

.container-6-4-2 {
    @include responsive-columns(2, 4, 6);
}